# @auth/sequelize-adapter – Sequelize Model Definitions

This section documents the Sequelize models that are automatically generated by the **@auth/sequelize-adapter**.  
Each model corresponds to a table in the database and contains the fields that Auth.js expects for authentication, session handling, and verification tokens.

> **Tip** – All examples below use the default `DataTypes` from Sequelize.  
> If you need custom data types or constraints, you can override the defaults in your own model definitions.

---

## 1. `Account` Model

| Field | Type | Constraints | Default |
|-------|------|-------------|---------|
| `access_token` | `STRING` |  |  |
| `expires_at` | `INTEGER` |  |  |
| `id` | `UUID` | `primaryKey: true` | `UUIDV4` |
| `id_token` | `TEXT` |  |  |
| `provider` | `STRING` | `allowNull: false` |  |
| `providerAccountId` | `STRING` | `allowNull: false` |  |
| `refresh_token` | `STRING` |  |  |
| `scope` | `STRING` |  |  |
| `session_state` | `STRING` |  |  |
| `token_type` | `STRING` |  |  |
| `type` | `STRING` | `allowNull: false` |  |
| `userId` | `UUID` |  |  |

```ts
import { DataTypes } from 'sequelize';

export const Account = sequelize.define('Account', {
  access_token: {
    type: DataTypes.STRING,
  },
  expires_at: {
    type: DataTypes.INTEGER,
  },
  id: {
    type: DataTypes.UUID,
    primaryKey: true,
    defaultValue: DataTypes.UUIDV4,
  },
  id_token: {
    type: DataTypes.TEXT,
  },
  provider: {
    type: DataTypes.STRING,
    allowNull: false,
  },
  providerAccountId: {
    type: DataTypes.STRING,
    allowNull: false,
  },
  refresh_token: {
    type: DataTypes.STRING,
  },
  scope: {
    type: DataTypes.STRING,
  },
  session_state: {
    type: DataTypes.STRING,
  },
  token_type: {
    type: DataTypes.STRING,
  },
  type: {
    type: DataTypes.STRING,
    allowNull: false,
  },
  userId: {
    type: DataTypes.UUID,
  },
});
```

---

## 2. `Session` Model

| Field | Type | Constraints | Default |
|-------|------|-------------|---------|
| `expires` | `DATE` | `allowNull: false` |  |
| `id` | `UUID` | `primaryKey: true` | `UUIDV4` |
| `sessionToken` | `STRING` | `allowNull: false`, `unique: true` |  |
| `userId` | `UUID` |  |  |

```ts
export const Session = sequelize.define('Session', {
  expires: {
    type: DataTypes.DATE,
    allowNull: false,
  },
  id: {
    type: DataTypes.UUID,
    primaryKey: true,
    defaultValue: DataTypes.UUIDV4,
  },
  sessionToken: {
    type: DataTypes.STRING,
    allowNull: false,
    unique: 'sessionToken',
  },
  userId: {
    type: DataTypes.UUID,
  },
});
```

---

## 3. `User` Model

| Field | Type | Constraints | Default |
|-------|------|-------------|---------|
| `email` | `STRING` | `unique: true` |  |
| `emailVerified` | `DATE` |  |  |
| `id` | `UUID` | `primaryKey: true` | `UUIDV4` |
| `image` | `STRING` |  |  |
| `name` | `STRING` |  |  |

```ts
export const User = sequelize.define('User', {
  email: {
    type: DataTypes.STRING,
    unique: 'email',
  },
  emailVerified: {
    type: DataTypes.DATE,
  },
  id: {
    type: DataTypes.UUID,
    primaryKey: true,
    defaultValue: DataTypes.UUIDV4,
  },
  image: {
    type: DataTypes.STRING,
  },
  name: {
    type: DataTypes.STRING,
  },
});
```

---

## 4. `VerificationToken` Model

| Field | Type | Constraints | Default |
|-------|------|-------------|---------|
| `expires` | `DATE` | `allowNull: false` |  |
| `identifier` | `STRING` | `allowNull: false` |  |
| `token` | `STRING` | `primaryKey: true` |  |

```ts
export const VerificationToken = sequelize.define('VerificationToken', {
  expires: {
    type: DataTypes.DATE,
    allowNull: false,
  },
  identifier: {
    type: DataTypes.STRING,
    allowNull: false,
  },
  token: {
    type: DataTypes.STRING,
    primaryKey: true,
  },
});
```

---

## Usage

Once the models are defined, you can use them directly with Sequelize or let Auth.js handle them internally.  
If you need to customize the models (e.g., add indexes, change data types), simply extend the definitions above and pass them to the adapter.

```ts
import { Sequelize } from 'sequelize';
import { SequelizeAdapter } from '@auth/sequelize-adapter';

const sequelize = new Sequelize(/* connection options */);

const adapter = SequelizeAdapter(sequelize, {
  // Override default models if needed
  User: CustomUserModel,
  Account: CustomAccountModel,
  // ...
});
```

---

### Common Pitfalls

| Issue | Fix |
|-------|-----|
| **UUID fields not auto‑generated** | Ensure `defaultValue: DataTypes.UUIDV4` is set on `id` fields. |
| **Unique constraints not enforced** | Use `unique: 'constraintName'` on fields that must be unique. |
| **Missing `allowNull: false`** | Add `allowNull: false` to required fields like `provider`, `type`, `sessionToken`, etc. |

---

## Further Reading

- [Auth.js Documentation – Adapters](https://authjs.dev/docs/adapters)
- [Sequelize Documentation – Data Types](https://sequelize.org/docs/v6/core-concepts/model-basics/#data-types)
- [Auth.js Migration Guide](https://authjs.dev/docs/migration)

---